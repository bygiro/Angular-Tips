angular.module("ng-tips",[]).directive("ngTips",["$timeout","$compile","$parse","$templateCache",function(e,t,n,o){var i=function(i,l,a){function p(e,t){var n,o,i,l;for(c(e)||(e={}),i=0;i<h.length;i++)if(o=h[i],n=g[o],void 0!==e[o]&&(n=e[o]),"string"==typeof n)for(n=n.split(" "),l=0;l<n.length;l++)v[o][n[l]]=v[o][n[l]]||[],v[o][n[l]].push(t)}var r,s,f=angular.element,c=angular.isObject,d=angular.extend,u=angular.copy,m={template:'<div class="tooltip fade"><div class="tooltip-arrow"></div><div class="tooltip-inner"><tips></tips></div></div>',"class":"",on:"mouseenter mouseover touchenter",off:"mouseleave mouseout touchleave",onOff:void 0,enable:void 0,placement:"right",tipCloseOn:!1,appendToBody:!0},g=d({},m,i.settings||{}),v={on:{},off:{}},h=["on","off"],T={},O={},y=(document.getElementById,["template","class","on","off","onOff","enable","placement","appendtoBody","tipCloseOn"]),b=i.tips;if("undefined"!=typeof b){for(var C=0;C<y.length;C++){var w=y[C];"undefined"!=typeof i[w]&&(g[w]=i[w])}for(var k=0;k<b.length;k++)p(b[k],k);i.getPosition=function(e,t){var n,o=e[0].getBoundingClientRect(),i=o.width,a=o.height,p=l[0].getBoundingClientRect(),r=p.top,s=p.left,f=p.width,c=p.height,d=window.scrollX||document.documentElement.scrollLeft,u=window.scrollY||document.documentElement.scrollTop,m=5,g=!1,v={};switch(t){case"top":g=s+f/2-i/2,n=r-a-m/2;break;case"bottom":g=s+f/2-i/2,n=r+c+m/2;break;case"left":g=s-i-m/2,n=r+c/2-a/2;break;case"right":default:g=s+f+m/2,n=r+c/2-a/2}return g!==!1&&(v={left:g+d+"px",top:n+u+"px"}),v};var $={};i.tipon=function(a){var p="on"+Object.keys(a);clearTimeout($[p]),$[p]=setTimeout(function(){e(function(){for(var p in a){var r,s,m,v=a[p],h=u(g);if(v&&!T[p]){if(c(v)?d(h,v):h.content=v,void 0!==h.enable&&!n(h.enable)(i.$parent))return;m=h.tipCloseOn,h.id=h.id||Math.random().toString(36).slice(2),tmpl=h.template,".html"==tmpl.slice(-5).toLowerCase()&&(tmpl=o.get(tmpl)),tmpl=tmpl||g.template,r=/^(right|left|top|bottom)$/gi.test(h.placement)?h.placement.toLowerCase():"right",s=f(tmpl.replace("<tips></tips>",h.content)),s=t(s)(i.$parent),"function"==typeof s[0].getBoundingClientRect&&(h.appendToBody?f(document.querySelectorAll("body")).append(s):l.after(s),T[p]=s,O[p]&&(O[p].remove(),delete O[p]),e(function(){s.attr("id",h.id).addClass(h["class"]+" "+r+" in").css(i.getPosition(s,r))}),m&&(s.on(h.tipCloseOn,function(){var e={};e[p]=v,i.tipoff(e)}),"click"==m&&s.css({cursor:"pointer"})))}}})},120)};var B;i.tipoff=function(e){var t="on"+Object.keys(e);clearTimeout($[t]),$[t]=setTimeout(function(){for(var t in e)T[t]&&(T[t].removeClass("in"),O[t]=T[t],delete T[t]);B||(B=setInterval(function(){for(var e in O)0==window.getComputedStyle(O[e][0]).opacity&&(O[e].remove(),delete O[e]);Object.keys(O).length||(clearInterval(B),B=!1)},100))},120)},r=Object.keys(v.on),s=Object.keys(v.off),l.on(r.concat(s).join(" "),function(e){for(var t,n=r.indexOf(e.type)>=0?"on":"off",o={},l=v[n][e.type],a=0;a<l.length;a++)t=l[a],o[t]=b[t];i["tip"+n](o)}),e(function(){for(var e=0;e<b.length;e++){var t=b[e],o=u(g);if((c(t)||void 0!==o.onOff)&&(c(t)&&(o=d(o,t)),void 0!==o.onOff)){var l={};l[e]=i.tips[e],i.$parent.$watch(function(e){return function(){return n(e)(i.$parent)}}(o.onOff),function(e){return function(t){var n=t?"on":"off";i["tip"+n](e)}}(l))}}})}};return{scope:{settings:"=ngTipsSettings",template:"=ngTipsTemplate","class":"=ngTipsClass",on:"=ngTipsOn",off:"=ngTipsOff",onOff:"=ngTipsOnOff",enable:"=ngTipsEnable",tipCloseOn:"=ngTipsTipCloseOn",placement:"=ngTipsPlacement",appendToBody:"=ngTipsAppendToBody",tips:"=ngTipsTips"},restrict:"A",link:i}}]);