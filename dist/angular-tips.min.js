angular.module("ng-tips",[]).directive("ngTips",["$timeout","$compile","$templateCache",function(e,t,n){var o=function(e,o,i){function l(t,n){for(var o,i=[],l=g[n][t.type],a=0;a<l.length;a++)o=l[a],i[o]=e.tips[o];"on"==n?e.showTip(i):e.hideTip(i)}function a(e,t){var n,o,i,l;for(angular.isObject(e)||(e={}),i=0;i<m.length;i++)for(o=m[i],n=d[o],e[o]&&(n=e[o]),n=n.split(" "),l=0;l<n.length;l++)g[o][n[l]]=g[o][n[l]]||[],g[o][n[l]].push(t)}for(var s,p,r=angular.element,c={template:'<div class="tooltip fade"><div class="tooltip-arrow"></div><div class="tooltip-inner"><tips></tips></div></div>',"class":"",on:"mouseenter mouseover touchenter",off:"mouseleave mouseout touchleave",placement:"right",appendToBody:!0},d=angular.extend({},c,e.settings||{}),g={on:{},off:{}},m=["on","off"],f={},u={},h=(document.getElementById,["template","class","on","off","placement","appendtoBody"]),v=0;v<h.length;v++){var T=h[v];"undefined"!=typeof e[T]&&(d[T]=e[T])}for(var y=0;y<e.tips.length;y++){var w=e.tips[y];a(w,y)}e.getPosition=function(e,t){var n,i=e[0].getBoundingClientRect(),l=i.width,a=i.height,s=o[0].getBoundingClientRect(),p=s.top,r=s.left,c=s.width,d=s.height,g=window.scrollX||document.documentElement.scrollLeft,m=window.scrollY||document.documentElement.scrollTop,f=5,u=!1,h={};switch(t){case"top":u=r+c/2-l/2,n=p-a-f/2;break;case"bottom":u=r+c/2-l/2,n=p+d+f/2;break;case"left":u=r-l-f/2,n=p+d/2-a/2;break;case"right":default:u=r+c+f/2,n=p+d/2-a/2}return u!==!1&&(h={left:u+g+"px",top:n+m+"px"}),h},e.showTip=function(i){for(var l=0;l<i.length;l++){var a,s,p=i[l],c=angular.copy(d);p&&!f[l]&&(angular.isObject(p)?angular.extend(c,p):c.content=p,c.id=c.id||Math.random().toString(36).slice(2),tmpl=c.template,".html"==tmpl.slice(-5).toLowerCase()&&(tmpl=n.get(tmpl)),tmpl=tmpl||d.template,a=/^(right|left|top|bottom)$/gi.test(c.placement)?c.placement.toLowerCase():"right",s=tmpl.replace("<tips></tips>",c.content),s=t(s)(e.$parent),c.appendToBody?r(document.querySelectorAll("body")).append(s):o.after(s),f[l]=s,u[l]&&(u[l].remove(),delete u[l]),s.attr("id",c.id).addClass(c["class"]+" "+a).css(e.getPosition(s,a)).addClass("in"))}};var b;e.hideTip=function(e){for(var t=0;t<e.length;t++)e[t]&&f[t]&&(f[t].removeClass("in"),u[t]=f[t],delete f[t]);b||(b=setInterval(function(){for(var e in u)0==window.getComputedStyle(u[e][0]).opacity&&(u[e].remove(),delete u[e]);Object.keys(u).length||(clearInterval(b),b=!1)},100))},s=Object.keys(g.on),p=Object.keys(g.off),o.on(s.join(" "),function(e){l(e,"on")}),o.on(p.join(" "),function(e){l(e,"off")})};return{scope:{settings:"=ngTipsSettings",template:"=ngTipsTemplate","class":"=ngTipsClass",on:"=ngTipsOn",off:"=ngTipsOff",placement:"=ngTipsPlacement",appendToBody:"=ngTipsAppendToBody",tips:"=ngTipsTips"},restrict:"A",link:o}}]);